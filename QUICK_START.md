# 🚀 快速啟動指南

## ⚡ 30秒快速啟動

### 1. 安裝依賴
```bash
npm install
```

### 2. 設定 Bot Token
編輯 `start-final.js` 第11行：
```javascript
process.env.TELEGRAM_BOT_TOKEN = '你的_Bot_Token_這裡';
```

### 3. 啟動系統
```bash
npm start
```

### 4. 開始使用
- **Telegram**: 將 Bot 加入群組，發送 `/start`
- **網頁面板**: 瀏覽器訪問 http://localhost:3000

---

## 📋 完整操作流程

### 🤖 Telegram Bot 設置

#### 步驟 1: 建立 Telegram Bot
1. 在 Telegram 中找到 `@BotFather`
2. 發送 `/newbot` 命令
3. 按照指示設定 Bot 名稱
4. **複製獲得的 Token**

#### 步驟 2: 設定 Token
1. 打開 `start-final.js` 檔案
2. 找到第11行並替換 Token：
   ```javascript
   process.env.TELEGRAM_BOT_TOKEN = '8134343577:AAF_U30xi1Gw1aDk05MdIgzbX8i_eit_XKo';
   ```
   改為：
   ```javascript
   process.env.TELEGRAM_BOT_TOKEN = '你的_實際_Token';
   ```

#### 步驟 3: 將 Bot 加入群組
1. 將 Bot 邀請到工作群組
2. 給予 Bot 管理員權限（建議）
3. 在群組中發送 `/start` 初始化

### 🌐 網頁數據面板使用

#### 主要功能區域
1. **控制面板**
   - 選擇群組：下拉選單選擇要查看的群組
   - 時間範圍：今日/昨日/本週/上週/本月/上月
   - 載入數據：點擊「📊 載入數據」更新顯示

2. **統計卡片區**
   - 👥 總員工數
   - 📊 總活動次數  
   - ⏱️ 總活動時間
   - 🔴 目前活動中

3. **員工詳細區**
   - 效率評分徽章（綠色≥80%, 橙色≥60%, 紅色<60%）
   - 個人統計數據
   - 點擊「📋 查看詳細」進入個人頁面

4. **即時狀態區**
   - 顯示正在進行的活動
   - 狀態指示：✅正常 ⚠️警告 🚨超時

5. **報告下載區**
   - 📄 下載 TXT 報告
   - 📊 下載 Excel 報告
   - 🖨️ 列印報告

### 📊 Excel 報告使用

#### 6個工作表說明
1. **📊 總覽統計** - 群組整體數據摘要
2. **👥 員工詳細統計** - 個人效率評分和表現
3. **📊 活動明細** - 每種活動的詳細分析
4. **🕐 時段分析** - 24小時熱力圖
5. **🔴 即時狀態** - 當前活動狀況
6. **📅 日期分析** - 每日活動趨勢

#### 如何分析報告
1. **查看總覽** - 了解整體效率和活動分佈
2. **分析員工表現** - 找出高效率和需改進的員工
3. **時段優化** - 利用熱力圖優化工作時間安排
4. **趨勢分析** - 觀察日期變化找出模式

---

## 🔧 進階設定

### 修改活動類型時間限制
編輯 `src/shared/constants/ActivityTypes.js`：
```javascript
export const ACTIVITY_LIMITS = {
    toilet: 6 * 60,      // 6分鐘
    smoking: 5 * 60,     // 5分鐘
    poop_10: 10 * 60,    // 10分鐘
    poop_15: 15 * 60,    // 15分鐘
    phone: 10 * 60       // 10分鐘
};
```

### 修改定時任務時間
編輯 `start-final.js` 第14行：
```javascript
process.env.REPORT_TIME = '23:00';  // 改為您想要的時間
```

### 修改網頁服務埠口
編輯 `start-final.js` 第17行：
```javascript
process.env.PORT = '3000';  // 改為其他埠口
```

---

## 🐛 常見問題快速解決

### ❌ Bot 無法回應
**問題**: Bot 加入群組後沒有反應  
**解決**:
1. 檢查 Token 是否正確設定
2. 確認 Bot 有群組權限
3. 重新發送 `/start` 命令

### ❌ 網頁無法開啟
**問題**: http://localhost:3000 無法訪問  
**解決**:
1. 確認應用程式已啟動成功
2. 檢查 3000 埠口是否被占用
3. 查看控制台錯誤訊息

### ❌ Excel 無法下載
**問題**: 點擊下載按鈕沒有反應  
**解決**:
1. 先載入數據（選擇群組和時間範圍）
2. 確認瀏覽器允許下載
3. 檢查是否有錯誤提示

### ❌ 自動存檔失敗
**問題**: 每日 23:00 沒有自動生成 Excel  
**解決**:
1. 檢查 `./archives/excel/` 目錄是否存在
2. 確認磁碟空間充足
3. 查看控制台是否有錯誤訊息

---

## 📱 Telegram 操作示範

### 基本操作流程
1. **開始活動**
   ```
   用戶: 點擊 "🚽 上廁所" 按鈕
   Bot: ✅ 已開始記錄您的上廁所活動
        開始時間: 14:30:15
   ```

2. **結束活動**
   ```
   用戶: 點擊 "✅ 結束活動" 按鈕
   Bot: ✅ 活動已結束
        持續時間: 4分鐘30秒
        狀態: 正常
   ```

3. **超時警告**
   ```
   Bot: ⚠️ 提醒 @用戶名
        您的上廁所活動已進行 4分鐘
        接近6分鐘限制，請注意時間
   ```

4. **查看狀態**
   ```
   用戶: 點擊 "📊 查看狀態" 按鈕
   Bot: 📊 目前群組狀態
        活動中: 2人
        今日總活動: 25次
   ```

---

## 🎯 使用技巧

### 💡 管理技巧
1. **定期查看網頁面板** - 每週檢視員工效率趨勢
2. **利用 Excel 報告** - 月底生成完整分析報告
3. **關注超時警告** - 及時提醒員工注意時間
4. **觀察時段分析** - 優化休息時間安排

### 📈 分析技巧
1. **效率評分解讀**
   - 綠色 (≥80%): 表現優良
   - 橙色 (≥60%): 表現一般
   - 紅色 (<60%): 需要關注

2. **時段熱力圖應用**
   - 深色區域 = 活動頻繁時段
   - 淺色區域 = 活動較少時段
   - 可據此調整工作安排

3. **趨勢分析方法**
   - 比較不同時期的數據
   - 識別異常活動模式
   - 制定改進策略

---

## 🔄 系統維護

### 每日維護
- 檢查控制台是否有錯誤訊息
- 確認自動存檔是否正常執行

### 每週維護  
- 檢查 `./archives/excel/` 目錄大小
- 備份重要的活動數據檔案

### 每月維護
- 清理過期的日誌檔案
- 檢查系統效能和記憶體使用

---

**🆘 需要幫助?** 
- 查看完整 README.md 文檔
- 在 GitHub Issues 提交問題
- 檢查控制台錯誤訊息

**✨ 小提示**: 系統會自動每 30 秒刷新網頁數據，確保您看到的都是最新資訊！